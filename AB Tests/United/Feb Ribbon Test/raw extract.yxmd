<?xml version="1.0"?>
<AlteryxDocument yxmdVer="11.0">
  <Nodes>
    <Node ToolID="1">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="54" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords />
          <CachedCosmeticName />
          <File RecordLimit="" FileFormat="23">aka:PDW|||WITH
    MV AS
    (
SELECT DISTINCT
            MV_ID                  ,
            MV.CREATE_EST_DT       ,
            MV.MEMBER_BALANCE_NUM  ,
            SES.STOREFRONT_BRAND   ,
            O1.OFFER_STATUS_CD     ,
            O1.PRIORITY_IND        ,
            SES.CONFIGURATION_ID   ,
            SBD.BUCKET_RATIO       ,
            O1.PARENT_OFFER        ,
            O1.OFFER_NM            ,
            O1.OFFER_TYPE_NM       ,
            MEM.PARTNER_MEMBER_ID  ,
            MEM.EMAIL              ,
            MEM.FIRST_NM           ,
            MEM.LAST_NM            ,
            MEM.LP_ID              ,
            MEM.PARTNER_NM         ,
            MEM.ACCOUNT_CREATION_DT,
            MEM.MEMBERSHIP_LEVEL   ,
            MEM.COUNTRY_CD
       FROM
            MART.MEMBER_VALIDATION_FACT_VW MV
       JOIN
            MART.MEMBER_DIM_VW MEM
         ON
            MV.MEMBER_KEY = MEM.MEMBER_KEY
       JOIN
            MART.OFFER_SET_FACT_VW O
         ON
            MV.MV_ID = O.USER_MV_ID
       JOIN
            MART.OFFER_DIM_VW O1
         ON
            O.OFFER_KEY = O1.OFFER_KEY
       JOIN
            MART.SESSION_INFO_DIM_VW SES
         ON
            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY
  LEFT JOIN
            MART.SESSION_BUCKET_DIM_VW SBD
         ON
            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID
      WHERE
            OFFER_STATUS_CD = 'LIVE'
        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'
        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'
        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'
                    AND PARTNER_NM                           = 'UNITED AIRLINES'
    )
    ,
    REFUNDS AS
    (
     SELECT
            PAY.REMIT_TOTAL_PAYMENT_AMT,
            POST.ORDER_KEY             ,
            CREDIT_POSTING_BASE_AMT    ,
            CREDIT_POSTING_BONUS_AMT   ,
            PAY.PRESENTMENT_CURRENCY_CD,
            PAY.REMITTANCE_CURRENCY_CD ,
            POST.SALE_REFUND_IND
       FROM
            MART.POSTING_FACT_VW POST
       JOIN
            MART.PAYMENT_WITH_FX_FACT_VW PAY
         ON
            POST.ORDER_KEY       = PAY.ORDER_KEY
        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND
      WHERE
            POST.SALE_REFUND_IND = 'REFUND'
        AND PAY.SALE_REFUND_IND  = 'REFUND'
        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
    )
    ,
    ORDERS AS
    (
     SELECT
            O.ORDER_KEY                ,
            O.USER_MV_ID               ,
            PAY.PRESENTMENT_CURRENCY_CD,
            PAY.REMITTANCE_CURRENCY_CD ,
            CASE
                WHEN RE.ORDER_KEY IS NULL
                THEN POST.SALE_REFUND_IND
                ELSE RE.SALE_REFUND_IND
            END SALE_REFUND_IND,
            POST.CREDIT_POSTING_BASE_AMT +
            CASE
                WHEN RE.ORDER_KEY IS NOT NULL
                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +
                    RE.CREDIT_POSTING_BASE_AMT
                ELSE 0
            END CREDIT_POSTING_BASE_AMT,
            PAY.REMIT_TOTAL_PAYMENT_AMT +
            CASE
                WHEN RE.ORDER_KEY IS NOT NULL
                THEN RE.REMIT_TOTAL_PAYMENT_AMT
                ELSE 0
            END TOTAL_PAYMENT_AMT
       FROM
            MART.ORDER_TRANSACTION_FACT_VW O
       JOIN
            MART.OFFER_DIM_VW OFFER
         ON
            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY
       JOIN
            MART.POSTING_FACT_VW POST
         ON
            O.ORDER_KEY          = POST.ORDER_KEY
        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND
       JOIN
            MART.PAYMENT_WITH_FX_FACT_VW PAY
         ON
            O.ORDER_KEY = PAY.ORDER_KEY
  LEFT JOIN
            REFUNDS RE
         ON
            O.ORDER_KEY = RE.ORDER_KEY
      WHERE
            O.ORDER_STATUS         = 'COMPLETE'
        AND UPPER( O.SANDBOX_IND ) = 'FALSE'
        AND POST.SALE_REFUND_IND   = 'SALE'
        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'
        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'
        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,
                                    'GIFT'    ,
                                    'TRANSFER',
                                    'REINSTATE' )
        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
    )
    ,
    MV_ORDER AS
    (
     SELECT
            MV.CREATE_EST_DT              ,
            MV.PARTNER_MEMBER_ID          ,
            MV.EMAIL                      ,
            MV.FIRST_NM                   ,
            MV.LAST_NM                    ,
            MV.OFFER_STATUS_CD            ,
            MV.MEMBER_BALANCE_NUM         ,
            MV.ACCOUNT_CREATION_DT        ,
            MV.MV_ID                      ,
            MV.MEMBERSHIP_LEVEL           ,
            MV.COUNTRY_CD                 ,
            MV.PARTNER_NM                 ,
            MV.PARENT_OFFER  MV_OFFER_ID  ,
            MV.OFFER_TYPE_NM MV_OFFER_TYPE,
            MV.OFFER_NM                   ,
            MV.STOREFRONT_BRAND           ,
            MV.CONFIGURATION_ID           ,
            MV.BUCKET_RATIO               ,
            ORD.ORDER_KEY                 ,
            ORD.CREDIT_POSTING_BASE_AMT   ,
            ORD.TOTAL_PAYMENT_AMT         ,
            ORD.SALE_REFUND_IND           ,
            ORD.PRESENTMENT_CURRENCY_CD   ,
            ORD.REMITTANCE_CURRENCY_CD
       FROM
            MV
  LEFT JOIN
            ORDERS ORD
         ON
            MV.MV_ID = ORD.USER_MV_ID
    )
SELECT
    CREATE_EST_DT                    AS 'Create Date'        ,
    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,
    MV_ID                            AS 'Session Id'         ,
    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,
    CREDIT_POSTING_BASE_AMT          AS Points               ,
    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',
    TOTAL_PAYMENT_AMT                AS Revenue              ,
    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,
    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,
    MEMBERSHIP_LEVEL                 AS Tier                 ,
    COUNTRY_CD                       AS Country              ,
    MEMBER_BALANCE_NUM               AS Balance              ,
    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,
    EMAIL                                                    ,
    FIRST_NM                                                 ,
    LAST_NM                                                  ,
    MV_OFFER_ID   AS 'Parent Offer'                            ,
    MV_OFFER_TYPE AS Product                                   ,
    OFFER_NM                                                   ,
    STOREFRONT_BRAND AS 'Storefront Brand'                     ,
    CONFIGURATION_ID                                           ,
    BUCKET_RATIO                                               ,
    PARTNER_NM AS Partner                                      ,
    'BGT3'     AS Source
FROM
    MV_ORDER
WHERE
    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'
AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'
AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'</File>
          <FormatSpecificOptions>
            <PreSQL />
            <NoProgress>True</NoProgress>
            <CacheData>False</CacheData>
            <TableStyle>Quoted</TableStyle>
            <ReadUncommitted>False</ReadUncommitted>
            <PostSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>aka:PDW
Table=WITH
    MV AS
    (
SELECT DISTINCT
            MV_ID                  ,
            MV.CREATE_EST_DT       ,
            MV.MEMBER_BALANCE_NUM  ,
            SES.STOREFRONT_BRAND   ,
            O1.OFFER_STATUS_CD     ,
            O1.PRIORITY_IND        ,
            SES.CONFIGURATION_ID   ,
            SBD.BUCKET_RATIO       ,
            O1.PARENT_OFFER        ,
            O1.OFFER_NM            ,
            O1.OFFER_TYPE_NM       ,
            MEM.PARTNER_MEMBER_ID  ,
            MEM.EMAIL              ,
            MEM.FIRST_NM           ,
            MEM.LAST_NM            ,
            MEM.LP_ID              ,
            MEM.PARTNER_NM         ,
            MEM.ACCOUNT_CREATION_DT,
            MEM.MEMBERSHIP_LEVEL   ,
            MEM.COUNTRY_CD
       FROM
            MART.MEMBER_VALIDATION_FACT_VW MV
       JOIN
            MART.MEMBER_DIM_VW MEM
         ON
            MV.MEMBER_KEY = MEM.MEMBER_KEY
       JOIN
            MART.OFFER_SET_FACT_VW O
         ON
            MV.MV_ID = O.USER_MV_ID
       JOIN
            MART.OFFER_DIM_VW O1
         ON
            O.OFFER_KEY = O1.OFFER_KEY
       JOIN
            MART.SESSION_INFO_DIM_VW SES
         ON
            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY
  LEFT JOIN
            MART.SESSION_BUCKET_DIM_VW SBD
         ON
            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID
      WHERE
            OFFER_STATUS_CD = 'LIVE'
        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'
        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'
        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'
                    AND PARTNER_NM                           = 'UNITED AIRLINES'
    )
    ,
    REFUNDS AS
    (
     SELECT
            PAY.REMIT_TOTAL_PAYMENT_AMT,
            POST.ORDER_KEY             ,
            CREDIT_POSTING_BASE_AMT    ,
            CREDIT_POSTING_BONUS_AMT   ,
            PAY.PRESENTMENT_CURRENCY_CD,
            PAY.REMITTANCE_CURRENCY_CD ,
            POST.SALE_REFUND_IND
       FROM
            MART.POSTING_FACT_VW POST
       JOIN
            MART.PAYMENT_WITH_FX_FACT_VW PAY
         ON
            POST.ORDER_KEY       = PAY.ORDER_KEY
        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND
      WHERE
            POST.SALE_REFUND_IND = 'REFUND'
        AND PAY.SALE_REFUND_IND  = 'REFUND'
        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
    )
    ,
    ORDERS AS
    (
     SELECT
            O.ORDER_KEY                ,
            O.USER_MV_ID               ,
            PAY.PRESENTMENT_CURRENCY_CD,
            PAY.REMITTANCE_CURRENCY_CD ,
            CASE
                WHEN RE.ORDER_KEY IS NULL
                THEN POST.SALE_REFUND_IND
                ELSE RE.SALE_REFUND_IND
            END SALE_REFUND_IND,
            POST.CREDIT_POSTING_BASE_AMT +
            CASE
                WHEN RE.ORDER_KEY IS NOT NULL
                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +
                    RE.CREDIT_POSTING_BASE_AMT
                ELSE 0
            END CREDIT_POSTING_BASE_AMT,
            PAY.REMIT_TOTAL_PAYMENT_AMT +
            CASE
                WHEN RE.ORDER_KEY IS NOT NULL
                THEN RE.REMIT_TOTAL_PAYMENT_AMT
                ELSE 0
            END TOTAL_PAYMENT_AMT
       FROM
            MART.ORDER_TRANSACTION_FACT_VW O
       JOIN
            MART.OFFER_DIM_VW OFFER
         ON
            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY
       JOIN
            MART.POSTING_FACT_VW POST
         ON
            O.ORDER_KEY          = POST.ORDER_KEY
        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND
       JOIN
            MART.PAYMENT_WITH_FX_FACT_VW PAY
         ON
            O.ORDER_KEY = PAY.ORDER_KEY
  LEFT JOIN
            REFUNDS RE
         ON
            O.ORDER_KEY = RE.ORDER_KEY
      WHERE
            O.ORDER_STATUS         = 'COMPLETE'
        AND UPPER( O.SANDBOX_IND ) = 'FALSE'
        AND POST.SALE_REFUND_IND   = 'SALE'
        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'
        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'
        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,
                                    'GIFT'    ,
                                    'TRANSFER',
                                    'REINSTATE' )
        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
    )
    ,
    MV_ORDER AS
    (
     SELECT
            MV.CREATE_EST_DT              ,
            MV.PARTNER_MEMBER_ID          ,
            MV.EMAIL                      ,
            MV.FIRST_NM                   ,
            MV.LAST_NM                    ,
            MV.OFFER_STATUS_CD            ,
            MV.MEMBER_BALANCE_NUM         ,
            MV.ACCOUNT_CREATION_DT        ,
            MV.MV_ID                      ,
            MV.MEMBERSHIP_LEVEL           ,
            MV.COUNTRY_CD                 ,
            MV.PARTNER_NM                 ,
            MV.PARENT_OFFER  MV_OFFER_ID  ,
            MV.OFFER_TYPE_NM MV_OFFER_TYPE,
            MV.OFFER_NM                   ,
            MV.STOREFRONT_BRAND           ,
            MV.CONFIGURATION_ID           ,
            MV.BUCKET_RATIO               ,
            ORD.ORDER_KEY                 ,
            ORD.CREDIT_POSTING_BASE_AMT   ,
            ORD.TOTAL_PAYMENT_AMT         ,
            ORD.SALE_REFUND_IND           ,
            ORD.PRESENTMENT_CURRENCY_CD   ,
            ORD.REMITTANCE_CURRENCY_CD
       FROM
            MV
  LEFT JOIN
            ORDERS ORD
         ON
            MV.MV_ID = ORD.USER_MV_ID
    )
SELECT
    CREATE_EST_DT                    AS 'Create Date'        ,
    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,
    MV_ID                            AS 'Session Id'         ,
    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,
    CREDIT_POSTING_BASE_AMT          AS Points               ,
    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',
    TOTAL_PAYMENT_AMT                AS Revenue              ,
    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,
    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,
    MEMBERSHIP_LEVEL                 AS Tier                 ,
    COUNTRY_CD                       AS Country              ,
    MEMBER_BALANCE_NUM               AS Balance              ,
    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,
    EMAIL                                                    ,
    FIRST_NM                                                 ,
    LAST_NM                                                  ,
    MV_OFFER_ID   AS 'Parent Offer'                            ,
    MV_OFFER_TYPE AS Product                                   ,
    OFFER_NM                                                   ,
    STOREFRONT_BRAND AS 'Storefront Brand'                     ,
    CONFIGURATION_ID                                           ,
    BUCKET_RATIO                                               ,
    PARTNER_NM AS Partner                                      ,
    'BGT3'     AS Source
FROM
    MV_ORDER
WHERE
    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'
AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'
AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'
AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <Dependencies>
          <Implicit />
        </Dependencies>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="Create Date" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="DateTime" />
            <Field name="DAY" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="DateTime" />
            <Field name="Session Id" size="36" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Transaction Id" size="20" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Points" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="Int64" />
            <Field name="Remittance Currency" size="3" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Revenue" scale="22" size="93" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="FixedDecimal" />
            <Field name="Sale Refund Ind" size="6" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Enrollment Date" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="DateTime" />
            <Field name="Tier" size="100" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Country" size="50" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Balance" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="Int64" />
            <Field name="Member Id" size="510" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="EMAIL" size="255" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="FIRST_NM" size="100" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="LAST_NM" size="100" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Parent Offer" size="36" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Product" size="50" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="OFFER_NM" size="100" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Storefront Brand" size="100" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="CONFIGURATION_ID" size="100" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="BUCKET_RATIO" scale="10" size="20" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="FixedDecimal" />
            <Field name="Partner" size="50" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
            <Field name="Source" size="4" source="File: aka:PDW|||WITH&#xA;    MV AS&#xA;    (&#xA;SELECT DISTINCT&#xA;            MV_ID                  ,&#xA;            MV.CREATE_EST_DT       ,&#xA;            MV.MEMBER_BALANCE_NUM  ,&#xA;            SES.STOREFRONT_BRAND   ,&#xA;            O1.OFFER_STATUS_CD     ,&#xA;            O1.PRIORITY_IND        ,&#xA;            SES.CONFIGURATION_ID   ,&#xA;            SBD.BUCKET_RATIO       ,&#xA;            O1.PARENT_OFFER        ,&#xA;            O1.OFFER_NM            ,&#xA;            O1.OFFER_TYPE_NM       ,&#xA;            MEM.PARTNER_MEMBER_ID  ,&#xA;            MEM.EMAIL              ,&#xA;            MEM.FIRST_NM           ,&#xA;            MEM.LAST_NM            ,&#xA;            MEM.LP_ID              ,&#xA;            MEM.PARTNER_NM         ,&#xA;            MEM.ACCOUNT_CREATION_DT,&#xA;            MEM.MEMBERSHIP_LEVEL   ,&#xA;            MEM.COUNTRY_CD&#xA;       FROM&#xA;            MART.MEMBER_VALIDATION_FACT_VW MV&#xA;       JOIN&#xA;            MART.MEMBER_DIM_VW MEM&#xA;         ON&#xA;            MV.MEMBER_KEY = MEM.MEMBER_KEY&#xA;       JOIN&#xA;            MART.OFFER_SET_FACT_VW O&#xA;         ON&#xA;            MV.MV_ID = O.USER_MV_ID&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW O1&#xA;         ON&#xA;            O.OFFER_KEY = O1.OFFER_KEY&#xA;       JOIN&#xA;            MART.SESSION_INFO_DIM_VW SES&#xA;         ON&#xA;            O.SESSION_INFO_KEY = SES.SESSION_INFO_KEY&#xA;  LEFT JOIN&#xA;            MART.SESSION_BUCKET_DIM_VW SBD&#xA;         ON&#xA;            SES.CONFIGURATION_ID = SBD.BUCKET_CONFIGURATION_ID&#xA;      WHERE&#xA;            OFFER_STATUS_CD = 'LIVE'&#xA;        AND MV.CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;        AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;        AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;        AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'&#xA;                    AND PARTNER_NM                           = 'UNITED AIRLINES'&#xA;    )&#xA;    ,&#xA;    REFUNDS AS&#xA;    (&#xA;     SELECT&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT,&#xA;            POST.ORDER_KEY             ,&#xA;            CREDIT_POSTING_BASE_AMT    ,&#xA;            CREDIT_POSTING_BONUS_AMT   ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            POST.SALE_REFUND_IND&#xA;       FROM&#xA;            MART.POSTING_FACT_VW POST&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            POST.ORDER_KEY       = PAY.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = PAY.SALE_REFUND_IND&#xA;      WHERE&#xA;            POST.SALE_REFUND_IND = 'REFUND'&#xA;        AND PAY.SALE_REFUND_IND  = 'REFUND'&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    ORDERS AS&#xA;    (&#xA;     SELECT&#xA;            O.ORDER_KEY                ,&#xA;            O.USER_MV_ID               ,&#xA;            PAY.PRESENTMENT_CURRENCY_CD,&#xA;            PAY.REMITTANCE_CURRENCY_CD ,&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NULL&#xA;                THEN POST.SALE_REFUND_IND&#xA;                ELSE RE.SALE_REFUND_IND&#xA;            END SALE_REFUND_IND,&#xA;            POST.CREDIT_POSTING_BASE_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN POST.CREDIT_POSTING_BONUS_AMT + RE.CREDIT_POSTING_BONUS_AMT +&#xA;                    RE.CREDIT_POSTING_BASE_AMT&#xA;                ELSE 0&#xA;            END CREDIT_POSTING_BASE_AMT,&#xA;            PAY.REMIT_TOTAL_PAYMENT_AMT +&#xA;            CASE&#xA;                WHEN RE.ORDER_KEY IS NOT NULL&#xA;                THEN RE.REMIT_TOTAL_PAYMENT_AMT&#xA;                ELSE 0&#xA;            END TOTAL_PAYMENT_AMT&#xA;       FROM&#xA;            MART.ORDER_TRANSACTION_FACT_VW O&#xA;       JOIN&#xA;            MART.OFFER_DIM_VW OFFER&#xA;         ON&#xA;            O.CHOSEN_OFFER_KEY = OFFER.OFFER_KEY&#xA;       JOIN&#xA;            MART.POSTING_FACT_VW POST&#xA;         ON&#xA;            O.ORDER_KEY          = POST.ORDER_KEY&#xA;        AND POST.SALE_REFUND_IND = O.SALE_REFUND_IND&#xA;       JOIN&#xA;            MART.PAYMENT_WITH_FX_FACT_VW PAY&#xA;         ON&#xA;            O.ORDER_KEY = PAY.ORDER_KEY&#xA;  LEFT JOIN&#xA;            REFUNDS RE&#xA;         ON&#xA;            O.ORDER_KEY = RE.ORDER_KEY&#xA;      WHERE&#xA;            O.ORDER_STATUS         = 'COMPLETE'&#xA;        AND UPPER( O.SANDBOX_IND ) = 'FALSE'&#xA;        AND POST.SALE_REFUND_IND   = 'SALE'&#xA;        AND PAY.PAYMENT_STATUS_CD  = 'SUCCESS'&#xA;        AND PAY.PAYMENT_TYPE_CD    = 'CAPTURE'&#xA;        AND OFFER.OFFER_TYPE_NM IN ( 'BUY'    ,&#xA;                                    'GIFT'    ,&#xA;                                    'TRANSFER',&#xA;                                    'REINSTATE' )&#xA;        AND PAY.PAYMENT_CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;    )&#xA;    ,&#xA;    MV_ORDER AS&#xA;    (&#xA;     SELECT&#xA;            MV.CREATE_EST_DT              ,&#xA;            MV.PARTNER_MEMBER_ID          ,&#xA;            MV.EMAIL                      ,&#xA;            MV.FIRST_NM                   ,&#xA;            MV.LAST_NM                    ,&#xA;            MV.OFFER_STATUS_CD            ,&#xA;            MV.MEMBER_BALANCE_NUM         ,&#xA;            MV.ACCOUNT_CREATION_DT        ,&#xA;            MV.MV_ID                      ,&#xA;            MV.MEMBERSHIP_LEVEL           ,&#xA;            MV.COUNTRY_CD                 ,&#xA;            MV.PARTNER_NM                 ,&#xA;            MV.PARENT_OFFER  MV_OFFER_ID  ,&#xA;            MV.OFFER_TYPE_NM MV_OFFER_TYPE,&#xA;            MV.OFFER_NM                   ,&#xA;            MV.STOREFRONT_BRAND           ,&#xA;            MV.CONFIGURATION_ID           ,&#xA;            MV.BUCKET_RATIO               ,&#xA;            ORD.ORDER_KEY                 ,&#xA;            ORD.CREDIT_POSTING_BASE_AMT   ,&#xA;            ORD.TOTAL_PAYMENT_AMT         ,&#xA;            ORD.SALE_REFUND_IND           ,&#xA;            ORD.PRESENTMENT_CURRENCY_CD   ,&#xA;            ORD.REMITTANCE_CURRENCY_CD&#xA;       FROM&#xA;            MV&#xA;  LEFT JOIN&#xA;            ORDERS ORD&#xA;         ON&#xA;            MV.MV_ID = ORD.USER_MV_ID&#xA;    )&#xA;SELECT&#xA;    CREATE_EST_DT                    AS 'Create Date'        ,&#xA;    DATE_TRUNC('DAY', CREATE_EST_DT) AS 'DAY'                ,&#xA;    MV_ID                            AS 'Session Id'         ,&#xA;    CAST(ORDER_KEY AS VARCHAR)       AS 'Transaction Id'     ,&#xA;    CREDIT_POSTING_BASE_AMT          AS Points               ,&#xA;    REMITTANCE_CURRENCY_CD           AS 'Remittance Currency',&#xA;    TOTAL_PAYMENT_AMT                AS Revenue              ,&#xA;    SALE_REFUND_IND                  AS 'Sale Refund Ind'    ,&#xA;    ACCOUNT_CREATION_DT              AS 'Enrollment Date'    ,&#xA;    MEMBERSHIP_LEVEL                 AS Tier                 ,&#xA;    COUNTRY_CD                       AS Country              ,&#xA;    MEMBER_BALANCE_NUM               AS Balance              ,&#xA;    UPPER(PARTNER_MEMBER_ID)         AS 'Member Id'          ,&#xA;    EMAIL                                                    ,&#xA;    FIRST_NM                                                 ,&#xA;    LAST_NM                                                  ,&#xA;    MV_OFFER_ID   AS 'Parent Offer'                            ,&#xA;    MV_OFFER_TYPE AS Product                                   ,&#xA;    OFFER_NM                                                   ,&#xA;    STOREFRONT_BRAND AS 'Storefront Brand'                     ,&#xA;    CONFIGURATION_ID                                           ,&#xA;    BUCKET_RATIO                                               ,&#xA;    PARTNER_NM AS Partner                                      ,&#xA;    'BGT3'     AS Source&#xA;FROM&#xA;    MV_ORDER&#xA;WHERE&#xA;    CREATE_EST_DT BETWEEN '2017-02-20 00:00:01' AND '2017-04-24 23:59:59'&#xA;AND UPPER( NVL( EMAIL, 'NULL' ) ) NOT LIKE '%POINTS.COM'&#xA;AND UPPER( NVL( FIRST_NM, 'FIRST' ) )   != 'TEST'&#xA;AND UPPER( NVL( LAST_NM, 'LAST' ) )     != 'TEST'" type="V_WString" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="2">
      <GuiSettings Plugin="AlteryxBasePluginsGui.AlteryxSelect.AlteryxSelect">
        <Position x="174" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <OrderChanged value="False" />
          <SelectFields>
            <SelectField field="*Unknown" selected="True" />
          </SelectFields>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSelect" />
    </Node>
    <Node ToolID="3">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
        <Position x="294" y="54" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <File MaxRecords="" FileFormat="0">C:\Users\kelvin.ye\workplace\data-wizards\AB Tests\United\Feb Ribbon Test\Feb Ribbon Test Raw.csv</File>
          <Passwords />
          <FormatSpecificOptions>
            <LineEndStyle>CRLF</LineEndStyle>
            <Delimeter>,</Delimeter>
            <ForceQuotes>False</ForceQuotes>
            <HeaderRow>True</HeaderRow>
            <CodePage>28591</CodePage>
            <WriteBOM>True</WriteBOM>
          </FormatSpecificOptions>
          <MultiFile value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Feb Ribbon Test Raw.csv</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <Dependencies>
          <Implicit />
        </Dependencies>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
    </Node>
    <Node ToolID="4">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
        <Position x="294" y="270" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <File FileFormat="42" MaxRecords="">C:\Users\kelvin.ye\workplace\data-wizards\AB Tests\United\May Instant Offer Select\Feb Ribbon Test Raw.tde</File>
          <Passwords />
          <FormatSpecificOptions>
            <OutputOption>Create</OutputOption>
          </FormatSpecificOptions>
          <MultiFile value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Feb Ribbon Test Raw.tde</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <Dependencies>
          <Implicit />
        </Dependencies>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
    </Node>
  </Nodes>
  <Connections>
    <Connection>
      <Origin ToolID="1" Connection="Output" />
      <Destination ToolID="2" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="2" Connection="Output" />
      <Destination ToolID="3" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="2" Connection="Output" />
      <Destination ToolID="4" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="True" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="True" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>raw extract</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
      <Example>
        <Description />
        <File />
      </Example>
    </MetaInfo>
    <Events>
      <Enabled value="True" />
    </Events>
  </Properties>
</AlteryxDocument>